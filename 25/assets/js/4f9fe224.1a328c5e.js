"use strict";(self.webpackChunkhardware_software_interface=self.webpackChunkhardware_software_interface||[]).push([[3543],{5680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>y});var r=n(6540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(n),d=i,y=u["".concat(c,".").concat(d)]||u[d]||f[d]||a;return n?r.createElement(y,o(o({ref:t},p),{},{components:n})):r.createElement(y,o({ref:t},p))}));function y(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8924:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>f,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=n(8168),i=(n(6540),n(5680));const a={},o="Solution",l={unversionedId:"Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution/README",id:"Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution/README",title:"Solution",description:"Looking at the disassembly of the link binary, it is noticeable that there is no main function. This is a clear indicator that we have to find a way to call it ourselves.",source:"@site/docs/Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution/README.md",sourceDirName:"Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution",slug:"/Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution/",permalink:"/hardware-software-interface/25/Lab 12 - Capture The Flag/CTF/Drills/Tasks/Hidden in Plain Sight/solution/",draft:!1,tags:[],version:"current",frontMatter:{}},c={},s=[],p={toc:s},u="wrapper";function f(e){let{components:t,...n}=e;return(0,i.yg)(u,(0,r.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"solution"},"Solution"),(0,i.yg)("p",null,"Looking at the disassembly of the ",(0,i.yg)("inlineCode",{parentName:"p"},"link")," binary, it is noticeable that there is no ",(0,i.yg)("inlineCode",{parentName:"p"},"main")," function. This is a clear indicator that we have to find a way to call it ourselves."),(0,i.yg)("p",null,"We define a ",(0,i.yg)("inlineCode",{parentName:"p"},"get_flag()")," function prototype as void (you may be able to skip this step, but there will be an implicit declaration error during compilation) and we call it in our main function. We then compile and assemble the file:\n",(0,i.yg)("inlineCode",{parentName:"p"},"gcc -g -m32 -z execstack -fno-PIC -fno-stack-protector -c main.c")),(0,i.yg)("p",null,"We then link it to the ",(0,i.yg)("inlineCode",{parentName:"p"},"link")," binary:\n",(0,i.yg)("inlineCode",{parentName:"p"},"gcc -no-pie -m32 link main.o -o a.out")))}f.isMDXComponent=!0}}]);